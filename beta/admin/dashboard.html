<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - StackPages CMS </title>
    <link rel="icon" type="image/x-icon" href="https://stackpages.net/img/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="./../core/WhatsappChatBox.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Prism.js for Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Dark mode classes */
        body.dark {
            background-color: #1e1e1e;
            color: #e2e8f0;
        }

        body.dark .bg-white {
            background-color: #252526 !important;
        }

        body.dark .bg-slate-50 {
            background-color: #1e1e1e !important;
        }

        body.dark .text-slate-800,
        body.dark .text-slate-700,
        body.dark .text-slate-600 {
            color: #cbd5e1 !important;
        }

        body.dark .border-slate-200,
        body.dark .border-slate-100 {
            border-color: #374151 !important;
        }

        body.dark .glass-panel {
            background: rgba(37, 37, 38, 0.7);
            border-color: rgba(55, 65, 81, 0.5);
        }

        /* Dark mode toggle */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: #cbd5e1;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .theme-toggle.dark {
            background: #475569;
        }

        .theme-toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .theme-toggle.dark .theme-toggle-slider {
            transform: translateX(30px);
            background: #64748b;
        }

        /* Dark mode hover improvements */
        body.dark .hover\:bg-orange-50:hover {
            background-color: #334155 !important;
        }

        body.dark .hover\:bg-slate-50:hover {
            background-color: #334155 !important;
        }

        body.dark .hover\:bg-slate-100:hover {
            background-color: #374151 !important;
        }

        /* Keep Nouvelle Page button white in dark mode */
        body.dark .bg-gradient-to-r.from-orange-500 a.bg-white {
            background-color: white !important;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 h-screen flex overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-slate-200 flex flex-col z-10">
        <div class="p-6 border-b border-slate-100">
            <h1 class="text-xl font-bold">
                <a href="https://stackpages.net/" target="_blank" class="flex items-center gap-2">
                    <img src="https://stackpages.net/img/logo.png" alt="StackPages" class="h-8">
                    <span>StackPages</span>
                </a>
            </h1>
        </div>

        <nav class="flex-1 p-4 space-y-2">
            <button onclick="showView('dashboard')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center active-nav">
                <i class="fas fa-chart-pie w-6"></i> Tableau de bord
            </button>
            <button onclick="showView('content')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-newspaper w-6"></i> Articles
            </button>
            <button onclick="showView('videos')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-video w-6"></i> Vidéos
            </button>
            <button onclick="showView('podcasts')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-microphone w-6"></i> Podcasts
            </button>

            <div class="border-t border-slate-100 my-2"></div>

            <button onclick="showView('api-explorer')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-terminal w-6"></i> API Explorer
            </button>
            <button onclick="showView('builder')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-paint-brush w-6"></i> Frontend Builder
            </button>
            <button onclick="showView('page-creator')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-file-code w-6"></i> Pages Frame IDE
            </button>
            <button onclick="showView('analytics')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-chart-line w-6"></i> Google Analytics
            </button>

            <div class="border-t border-slate-100 my-2"></div>

            <button onclick="showView('config')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-cog w-6"></i> Configuration
            </button>
            <button onclick="showView('help')"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-question-circle w-6"></i> Aide & Support
            </button>
            <a href="https://docs.stackpages.net/" target="_blank"
                class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-orange-50 text-slate-600 hover:text-orange-600 flex items-center">
                <i class="fas fa-book w-6"></i> Documentation
            </a>
        </nav>

        <div class="p-4 border-t border-slate-100">
            <div class="flex items-center justify-between px-2">
                <div onclick="openGitHubConfig()"
                    class="flex items-center gap-3 cursor-pointer p-2 rounded-lg transition">
                    <div
                        class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-500 transition">
                        <i class="fab fa-github"></i>
                    </div>
                    <div class="text-sm">
                        <p id="gh-username-display" class="font-medium text-slate-700">Non
                            connecté</p>
                        <p id="dashboard-author" class="text-xs text-slate-500">Configurer GitHub</p>
                    </div>
                </div>
                <button onclick="logout()" class="text-slate-400 hover:text-red-500 transition p-2" title="Déconnexion">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-auto relative">
        <!-- Header -->
        <header class="sticky top-0 z-20 glass-panel px-8 py-4 flex justify-between items-center">
            <h2 id="page-title" class="text-xl font-semibold text-slate-800">Tableau de bord</h2>

            <!-- Theme Toggle Button -->
            <div class="flex items-center gap-3">
                <span class="text-sm text-slate-600" id="theme-label">Mode sombre</span>
                <div onclick="toggleDarkMode()" class="theme-toggle" id="theme-toggle">
                    <div class="theme-toggle-slider"></div>
                </div>
            </div>
            <div class="flex gap-3">
                <a id="header-site-btn" href="/" target="_blank"
                    class="px-4 py-2 text-sm font-medium text-slate-600 hover:text-orange-600 transition bg-white border border-slate-200 rounded-lg shadow-sm hover:shadow">
                    <i class="fas fa-external-link-alt mr-2"></i><span id="site-domain-link"></span>
                </a>
            </div>
        </header>

        <div class="p-8 max-w-7xl mx-auto space-y-8">

            <!-- VIEW: DASHBOARD -->
            <div id="view-dashboard" class="view-section space-y-6">
                <!-- Config Warning (Hidden by default) -->
                <div id="config-warning"
                    class="hidden bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r shadow-sm">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-orange-500 mt-0.5"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-orange-800">Configuration manquante</h3>
                            <div class="mt-1 text-sm text-orange-700">
                                <p>L'URL de votre flux RSS Substack n'est pas configurée. Vos articles ne peuvent pas
                                    s'afficher.</p>
                            </div>
                            <div class="mt-3">
                                <button onclick="showView('config')"
                                    class="text-sm font-medium text-orange-800 hover:text-orange-900 underline">
                                    Aller à la configuration <i class="fas fa-arrow-right ml-1"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-slate-500">Articles</p>
                                <h3 id="stat-total-posts" class="text-3xl font-bold text-slate-800 mt-2">-</h3>
                            </div>
                            <div class="p-3 bg-orange-50 rounded-lg text-orange-500">
                                <i class="fas fa-rss text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-slate-500">Vidéos</p>
                                <h3 id="stat-total-videos" class="text-3xl font-bold text-slate-800 mt-2">-</h3>
                            </div>
                            <div class="p-3 bg-red-50 rounded-lg text-red-500">
                                <i class="fab fa-youtube text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-slate-500">Podcasts</p>
                                <h3 id="stat-total-podcasts" class="text-3xl font-bold text-slate-800 mt-2">-</h3>
                            </div>
                            <div class="p-3 bg-purple-50 rounded-lg text-purple-500">
                                <i class="fas fa-microphone text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-slate-500">Pages</p>
                                <h3 id="stat-total-pages" class="text-3xl font-bold text-slate-800 mt-2">-</h3>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg text-blue-500">
                                <i class="fas fa-file-alt text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm font-medium text-slate-500">État du Flux</p>
                                <h3 id="stat-feed-status"
                                    class="text-lg font-bold text-slate-800 mt-2 flex items-center gap-2">
                                    <span class="w-2 h-2 rounded-full bg-slate-300"></span> Inconnu
                                </h3>
                            </div>
                            <div class="p-3 bg-green-50 rounded-lg text-green-500">
                                <i class="fas fa-globe text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden lg:col-span-2">
                        <div class="px-6 py-4 border-b border-slate-100">
                            <h3 class="font-semibold text-slate-800">Derniers Articles</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-50 text-slate-500 font-medium">
                                    <tr>
                                        <th class="px-6 py-3">Titre</th>
                                        <th class="px-6 py-3">Date</th>
                                        <th class="px-6 py-3 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-recent-posts" class="divide-y divide-slate-100">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden lg:col-span-2">
                        <div class="px-6 py-4 border-b border-slate-100">
                            <h3 class="font-semibold text-slate-800">Dernières Pages Publiées</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-50 text-slate-500 font-medium">
                                    <tr>
                                        <th class="px-6 py-3">Titre</th>
                                        <th class="px-6 py-3">Date</th>
                                        <th class="px-6 py-3 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-recent-pages" class="divide-y divide-slate-100">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                        <div class="px-6 py-4 border-b border-slate-100">
                            <h3 class="font-semibold text-slate-800">Dernières Vidéos</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-50 text-slate-500 font-medium">
                                    <tr>
                                        <th class="px-6 py-3">Titre</th>
                                        <th class="px-6 py-3">Date</th>
                                        <th class="px-6 py-3 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-recent-videos" class="divide-y divide-slate-100">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                        <div class="px-6 py-4 border-b border-slate-100">
                            <h3 class="font-semibold text-slate-800">Derniers Podcasts</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-50 text-slate-500 font-medium">
                                    <tr>
                                        <th class="px-6 py-3">Titre</th>
                                        <th class="px-6 py-3">Date</th>
                                        <th class="px-6 py-3 text-right">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-recent-podcasts" class="divide-y divide-slate-100">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: CONTENT -->
            <div id="view-content" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                        <div class="flex items-center gap-4">
                            <h3 class="font-semibold text-slate-800">Tous les Articles</h3>
                            <button onclick="loadData()" class="text-slate-400 hover:text-orange-500 transition"
                                title="Actualiser">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <input type="text" id="search-posts" placeholder="Rechercher..."
                            class="px-3 py-1.5 border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-slate-500 font-medium">
                                <tr>
                                    <th class="px-6 py-3">Image</th>
                                    <th class="px-6 py-3">Titre</th>
                                    <th class="px-6 py-3">Date</th>
                                    <th class="px-6 py-3 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="all-posts-table" class="divide-y divide-slate-100">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Pagination Controls -->
                    <div class="px-6 py-4 border-t border-slate-100 flex justify-between items-center bg-slate-50">
                        <span id="pagination-info" class="text-sm text-slate-500">Page 1 sur 1</span>
                        <div class="flex gap-2">
                            <button id="prev-page-btn" onclick="prevPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Précédent</button>
                            <button id="next-page-btn" onclick="nextPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: VIDEOS -->
            <div id="view-videos" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                        <div class="flex items-center gap-4">
                            <h3 class="font-semibold text-slate-800">Toutes les Vidéos</h3>
                            <button onclick="loadData()" class="text-slate-400 hover:text-orange-500 transition"
                                title="Actualiser">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <input type="text" id="search-videos" placeholder="Rechercher..."
                            class="px-3 py-1.5 border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-slate-500 font-medium">
                                <tr>
                                    <th class="px-6 py-3">Image</th>
                                    <th class="px-6 py-3">Titre</th>
                                    <th class="px-6 py-3">Date</th>
                                    <th class="px-6 py-3 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="videos-table" class="divide-y divide-slate-100">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination Controls -->
                    <div class="px-6 py-4 border-t border-slate-100 flex justify-between items-center bg-slate-50">
                        <span id="video-pagination-info" class="text-sm text-slate-500">Page 1 sur 1</span>
                        <div class="flex gap-2">
                            <button id="prev-video-page-btn" onclick="prevVideoPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Précédent</button>
                            <button id="next-video-page-btn" onclick="nextVideoPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: API EXPLORER -->
            <div id="view-api-explorer" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6">
                    <h3 class="font-semibold text-slate-800 mb-4">Tester les Endpoints</h3>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Left Column: Controls -->
                        <div class="space-y-4">
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/metadata</code>
                                <button onclick="testApi('/api/metadata')"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/posts</code>
                                <button onclick="testApi('/api/posts')"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/videos</code>
                                <button onclick="testApi('/api/videos')"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/podcasts</code>
                                <button onclick="testApi('/api/podcasts')"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/post/:slug</code>
                                <input type="text" id="api-slug-input" placeholder="slug-article"
                                    class="px-2 py-1 text-sm border border-slate-300 rounded w-32">
                                <button onclick="testApiSlug()"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/video/:id</code>
                                <input type="text" id="api-video-input" placeholder="id-video"
                                    class="px-2 py-1 text-sm border border-slate-300 rounded w-32">
                                <button onclick="testApiVideo()"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>
                            <div class="flex gap-4 items-center p-4 bg-slate-50 rounded-lg border border-slate-200">
                                <span
                                    class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-mono font-bold">GET</span>
                                <code class="text-sm font-mono text-slate-600">/api/podcast/:id</code>
                                <input type="text" id="api-podcast-input" placeholder="guid-ou-slug"
                                    class="px-2 py-1 text-sm border border-slate-300 rounded w-32">
                                <button onclick="testApiPodcast()"
                                    class="ml-auto px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50">Envoyer</button>
                            </div>

                        </div>

                        <!-- Right Column: Response -->
                        <div class="flex flex-col space-y-4">
                            <div>
                                <h4 id="api-response-title" class="text-sm font-medium text-slate-500 mb-2">Réponse</h4>
                                <pre id="api-output"
                                    class="bg-slate-900 text-green-400 p-4 rounded-lg text-xs font-mono h-[450px] overflow-auto">En attente...</pre>
                            </div>
                            <button onclick="clearApiOutput()"
                                class="w-full py-2 border border-slate-200 text-slate-500 hover:text-slate-700 hover:bg-slate-50 rounded-lg text-sm transition flex items-center justify-center gap-2">
                                <i class="fas fa-trash-alt"></i> Effacer la console
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: ANALYTICS -->
            <div id="view-analytics" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 bg-slate-50">
                        <h3 class="font-semibold text-slate-800">Rapports Google Analytics</h3>
                    </div>
                    <div class="p-6">
                        <iframe width="100%" height="600"
                            src="https://lookerstudio.google.com/embed/reporting/a2371327-f823-4c3d-85b2-d6d3084997fd/page/e1rgF"
                            frameborder="0" style="border:0" allowfullscreen
                            sandbox="allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
                    </div>
                </div>
            </div>

            <!-- VIEW: PODCASTS -->
            <div id="view-podcasts" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                        <div class="flex items-center gap-4">
                            <h3 class="font-semibold text-slate-800">Épisodes de Podcast</h3>
                            <button onclick="loadData()" class="text-slate-400 hover:text-orange-500 transition"
                                title="Actualiser">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <input type="text" id="search-podcasts" placeholder="Rechercher..."
                            class="px-3 py-1.5 border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-slate-500 font-medium">
                                <tr>
                                    <th class="px-6 py-3">Titre</th>
                                    <th class="px-6 py-3">Date</th>
                                    <th class="px-6 py-3 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="podcasts-table" class="divide-y divide-slate-100">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination Controls -->
                    <div class="px-6 py-4 border-t border-slate-100 flex justify-between items-center bg-slate-50">
                        <span id="podcast-pagination-info" class="text-sm text-slate-500">Page 1 sur 1</span>
                        <div class="flex gap-2">
                            <button id="prev-podcast-page-btn" onclick="prevPodcastPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Précédent</button>
                            <button id="next-podcast-page-btn" onclick="nextPodcastPage()"
                                class="px-3 py-1 bg-white border border-slate-300 rounded text-sm hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: CONFIGURATION -->
            <div id="view-config" class="view-section hidden space-y-6">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-8">
                    <div class="flex items-center justify-between mb-6 border-b pb-4">
                        <h3 class="font-semibold text-slate-800">Configuration du Site</h3>
                        <button onclick="loadSiteConfig()" class="text-slate-400 hover:text-orange-500 transition"
                            title="Actualiser">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>

                    <div id="config-loading" class="hidden text-center py-8">
                        <i class="fas fa-spinner fa-spin text-3xl text-orange-500"></i>
                        <p class="mt-2 text-slate-500">Chargement de la configuration...</p>
                    </div>

                    <form id="config-form" class="space-y-6">
                        <!-- Site Info -->
                        <div class="border-b pb-4">
                            <h4 class="text-sm font-medium text-slate-900 mb-4 flex items-center gap-2">
                                <i class="fas fa-globe text-orange-500"></i> Informations du Site
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Nom du Site</label>
                                    <input type="text" id="conf-siteName"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Domaine</label>
                                    <input type="url" id="conf-domain" placeholder="https://monsite.com"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Description</label>
                                    <textarea id="conf-description" rows="2"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Auteur</label>
                                    <input type="text" id="conf-author"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                            </div>
                        </div>

                        <!-- SEO -->
                        <div class="border-b pb-4">
                            <h4 class="text-sm font-medium text-slate-900 mb-4 flex items-center gap-2">
                                <i class="fas fa-search text-orange-500"></i> SEO & Métadonnées
                            </h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Titre Meta</label>
                                    <input type="text" id="conf-metaTitle"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Description
                                        Meta</label>
                                    <textarea id="conf-metaDesc" rows="2"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Mots-clés (séparés par
                                        virgule)</label>
                                    <input type="text" id="conf-metaKeywords" placeholder="blog, tech, innovation"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                            </div>
                        </div>

                        <!-- Theme -->
                        <div class="border-b pb-4">
                            <h4 class="text-sm font-medium text-slate-900 mb-4 flex items-center gap-2">
                                <i class="fas fa-palette text-orange-500"></i> Thème
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Template Actif</label>
                                    <select id="conf-activeTemplate"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                        <!-- Options loaded dynamically from /api/templates -->
                                    </select>
                                    <p class="text-xs text-slate-500 mt-1">Choisissez le template pour votre site</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Couleur
                                        Principale</label>
                                    <input type="text" id="conf-primaryColor" placeholder="#3B82F6"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                            </div>
                        </div>

                        <!-- Feeds -->
                        <div class="border-b pb-4">
                            <h4 class="text-sm font-medium text-slate-900 mb-4 flex items-center gap-2">
                                <i class="fas fa-rss text-orange-500"></i> Flux RSS
                            </h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">URL Substack
                                        RSS</label>
                                    <input type="url" id="conf-substack"
                                        placeholder="https://votresubstack.substack.com/feed"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">URL YouTube RSS</label>
                                    <input type="url" id="conf-youtube"
                                        placeholder="https://youtube.com/feeds/videos.xml?channel_id=..."
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">URL Podcast RSS</label>
                                    <input type="url" id="conf-podcast" placeholder="https://anchor.fm/.../podcast/rss"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                            </div>
                        </div>

                        <!-- Social -->
                        <div class="border-b pb-4">
                            <h4 class="text-sm font-medium text-slate-900 mb-4 flex items-center gap-2">
                                <i class="fas fa-share-alt text-orange-500"></i> Réseaux Sociaux
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Twitter</label>
                                    <input type="text" id="conf-twitter" placeholder="@moncompte"
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">LinkedIn</label>
                                    <input type="url" id="conf-linkedin" placeholder="https://linkedin.com/in/..."
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">GitHub</label>
                                    <input type="url" id="conf-github" placeholder="https://github.com/..."
                                        class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                                </div>
                            </div>
                        </div>

                        <!-- Save Button -->
                        <div class="flex items-center justify-between pt-4">
                            <button type="button" onclick="clearCache()"
                                class="bg-slate-100 hover:bg-slate-200 text-slate-700 px-4 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2">
                                <i class="fas fa-broom"></i> Vider le Cache
                            </button>
                            <button type="button" onclick="saveSiteConfig()"
                                class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white px-6 py-2.5 rounded-lg font-bold transition shadow-lg hover:shadow-xl flex items-center gap-2">
                                <i class="fas fa-save"></i> Enregistrer sur GitHub
                            </button>
                        </div>
                        <p id="config-status" class="text-sm text-center"></p>
                    </form>
                </div>
            </div>

            <!-- VIEW: BUILDER -->
            <div id="view-builder" class="view-section hidden space-y-6">
                <!-- Old Builder Content (Hidden) -->
                <!--
                <div class="grid grid-cols-1 lg:grid-cols-[2fr_3fr] gap-6 h-[calc(100vh-12rem)]">
                    <div
                        class="bg-white rounded-xl shadow-sm border border-slate-100 p-8 flex flex-col justify-center items-start space-y-8">
                        <div>
                            <div
                                class="w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center text-orange-600 mb-6">
                                <i class="fas fa-paint-brush text-3xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-slate-800 mb-3">Éditeur Visuel</h3>
                            <p class="text-slate-600 text-lg leading-relaxed">
                                Utilisez notre éditeur visuel avancé pour personnaliser l'apparence de votre site.
                                L'interface s'ouvrira dans un nouvel onglet pour vous offrir un espace de travail
                                optimal.
                            </p>
                        </div>

                        <a id="builder-tab-btn" href="https://apps.webstudio.is/dashboard" target="_blank"
                            class="inline-flex items-center gap-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white px-8 py-4 rounded-xl font-bold text-lg transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                            <span>Ouvrir le Builder</span>
                            <i class="fas fa-external-link-alt"></i>
                        </a>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r w-full">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-info-circle text-blue-500"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-blue-700">
                                        Regardez les tutoriels à droite pour apprendre à maîtriser l'outil.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden flex flex-col">
                        <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                            <h3 class="font-semibold text-slate-800">Tutoriels Vidéo</h3>
                            <span class="text-xs font-medium text-slate-500 uppercase tracking-wider">Playlist
                                YouTube</span>
                        </div>
                        <div class="flex-1 bg-black relative group">
                            <iframe width="100%" height="100%"
                                src="https://www.youtube-nocookie.com/embed/videoseries?si=YyePOX9RjcazflwN&amp;list=PL4vVqpngzeT4Bfs_D25xNi_qNMY99R928"
                                title="YouTube video player" frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                referrerpolicy="strict-origin-when-cross-origin" allowfullscreen
                                class="absolute inset-0 w-full h-full">
                            </iframe>
                        </div>
                    </div>
                </div>
                -->

                <!-- New Published Pages Gallery -->
                <div class="space-y-6">
                    <div>
                        <h3 class="text-2xl font-bold text-slate-800 dark:text-white">Pages Publiées</h3>
                        <p class="text-slate-500 dark:text-slate-400">Vos pages en ligne accessibles publiquement
                        </p>
                    </div>
                    <div class="flex gap-3">
                        <a href="/admin/visual-editor.html"
                            class="px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium transition flex items-center gap-2 shadow-lg shadow-orange-500/20">
                            <i class="fas fa-paint-brush"></i> Éditeur Visuel
                        </a>
                        <a href="/admin/IDE.html"
                            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition flex items-center gap-2 shadow-lg shadow-blue-500/20">
                            <i class="fas fa-plus"></i> Nouvelle Page (Code)
                        </a>
                    </div>
                </div>

                <div id="published-pages-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cards will be injected here -->
                </div>

                <div id="published-pages-empty"
                    class="hidden flex flex-col items-center justify-center py-20 text-center bg-slate-50 dark:bg-slate-800/50 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700">
                    <div
                        class="w-16 h-16 bg-white dark:bg-slate-700 rounded-full flex items-center justify-center mb-4 shadow-sm">
                        <i class="fas fa-globe text-3xl text-slate-400"></i>
                    </div>
                    <h3 class="text-lg font-medium text-slate-900 dark:text-white mb-2">Aucune page publiée</h3>
                    <p class="text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-6">
                        Créez et publiez des pages depuis l'IDE pour les voir apparaître ici.
                    </p>
                    <a href="/admin/IDE.html"
                        class="px-4 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-white rounded-lg font-medium hover:bg-slate-50 dark:hover:bg-slate-600 transition">
                        Créer une page
                    </a>
                </div>
            </div>
        </div>

        <!-- VIEW: PAGE CREATOR -->
        <div id="view-page-creator" class="view-section hidden space-y-6">
            <!-- Header with Create Button -->
            <div class="bg-gradient-to-r from-orange-500 to-red-500 rounded-xl shadow-lg p-8 text-white">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Pages Frame IDE</h2>
                        <p class="text-orange-100">Créez et gérez vos pages personnalisées</p>
                    </div>
                    <a href="/admin/IDE.html"
                        class="px-6 py-3 bg-white text-orange-600 hover:bg-orange-50 rounded-lg font-bold transition shadow-lg hover:shadow-xl flex items-center gap-2">
                        <i class="fas fa-plus-circle"></i>
                        Nouvelle Page
                    </a>
                </div>
            </div>

            <!-- Saved Pages List -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between">
                    <h3 class="font-semibold text-slate-800 flex items-center gap-2">
                        <i class="fas fa-list text-orange-500"></i>
                        Pages Sauvegardées
                    </h3>
                    <button onclick="loadSavedPages()" class="text-slate-400 hover:text-orange-500 transition"
                        title="Actualiser">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div id="saved-pages-list" class="p-6">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>


        <!-- VIEW: HELP -->
        <div id="view-help" class="view-section hidden space-y-6">
            <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-8 prose prose-orange max-w-none">
                <h3 class="font-semibold text-slate-800 mb-6 border-b pb-2">Guide d'utilisation</h3>

                <br>
                <h4>1. Tableau de bord</h4>
                <p>Visualisez un aperçu rapide de votre site, y compris le nombre d'articles et l'état de la
                    synchronisation avec Substack.</p>

                <br>
                <h4>2. Gestion des Contenus</h4>
                <ul class="list-disc pl-5 space-y-1">
                    <li><strong>Articles :</strong> Parcourez les articles récupérés depuis votre flux RSS Substack.
                    </li>
                    <li><strong>Vidéos :</strong> Consultez les dernières vidéos de votre chaîne YouTube.</li>
                    <li><strong>Podcasts :</strong> Écoutez et gérez vos épisodes de podcast.</li>
                </ul>

                <br>
                <h4>3. Outils Avancés</h4>
                <ul class="list-disc pl-5 space-y-1">
                    <li><strong>Frontend Builder :</strong> Personnalisez l'apparence de votre site via l'éditeur
                        visuel
                        Webstudio.</li>
                    <li><strong>API Explorer :</strong> Testez les endpoints de votre API directement depuis le
                        dashboard.
                        <ul class="list-circle pl-5 mt-1 text-sm text-slate-600">
                            <li><code>/api/metadata</code> : Informations du site</li>
                            <li><code>/api/posts</code> : Liste des articles</li>
                            <li><code>/api/post/:slug</code> : Détail d'un article</li>
                            <li><code>/api/videos</code> : Liste des vidéos</li>
                            <li><code>/api/video/:id</code> : Détail d'une vidéo (par ID YouTube)</li>
                            <li><code>/api/podcasts</code> : Liste des podcasts</li>
                            <li><code>/api/podcast/:id</code> : Détail d'un podcast (par GUID ou Slug)</li>
                        </ul>
                    </li>
                    <li><strong>Analytics :</strong> Consultez les rapports de trafic Google Analytics intégrés.
                    </li>
                </ul>

                <br>
                <h4>4. Configuration</h4>
                <p>La configuration de ce site est gérée par des <strong>variables d'environnement</strong> (sur
                    Cloudflare Workers ou via <code>wrangler.toml</code>). L'onglet Configuration affiche l'état
                    actuel
                    de ces variables :</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li><strong>SUBSTACK_FEED_URL</strong> : L'URL du flux RSS de votre newsletter Substack.</li>
                    <li><strong>YOUTUBE_FEED_URL</strong> : L'URL du flux RSS de votre chaîne YouTube.</li>
                    <li><strong>PODCAST_FEED_URL</strong> : L'URL du flux RSS de votre podcast.</li>
                    <li><strong>FRONTEND_BUILDER_URL</strong> : L'URL de votre projet Webstudio.</li>
                    <li><strong>META_TITLE / DESC / KEYWORDS</strong> : Paramètres SEO globaux du site.</li>
                </ul>
                <p class="mt-2">Pour modifier ces valeurs, vous devez mettre à jour les variables d'environnement de
                    votre déploiement Cloudflare.</p>


                <br>
                <h4>5. Maintenance</h4>
                <p>Utilisez le bouton <strong>Vider le Cache</strong> dans l'onglet Configuration si vous ne voyez
                    pas
                    vos derniers contenus apparaître immédiatement. Le système met en cache les données pour la
                    performance (TTL par défaut de 3 minutes).</p>
            </div>
        </div>

        </div>
    </main>

    <!-- Modal Preview -->
    <div id="preview-modal"
        class="fixed inset-0 z-50 hidden bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                <h3 id="modal-title" class="font-bold text-lg text-slate-800 truncate pr-4">Titre de l'article</h3>
                <button onclick="closeModal()" class="text-slate-400 hover:text-slate-600 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="modal-content" class="p-8 overflow-y-auto prose prose-orange max-w-none">
                <!-- Content -->
            </div>
        </div>
    </div>

    <!--
    <script>
        // CONFIGURATION: Si le frontend est hébergé séparément du worker
        // window.STACKPAGES_API_URL = "https://votre-worker.workers.dev";
    </script>
    -->
    <!-- GitHub Config Modal -->
    <div id="github-modal"
        class="fixed inset-0 z-50 hidden bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
        <div
            class="bg-white rounded-xl shadow-2xl w-full max-w-md border border-slate-200 transform transition-all scale-100">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                        <i class="fab fa-github text-slate-700"></i>
                        Configuration GitHub
                    </h3>
                    <button onclick="closeGitHubConfig()" class="text-slate-400 hover:text-slate-600 transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <div class="space-y-4">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r">
                        <p class="text-sm text-blue-700">
                            Configurez votre dépôt pour activer la publication automatique et le stockage gratuit.
                        </p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Nom d'utilisateur (Owner)</label>
                        <input type="text" id="gh-owner" placeholder="ex: mon-user"
                            class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Nom du Dépôt (Repo)</label>
                        <input type="text" id="gh-repo" placeholder="ex: mon-site-web"
                            class="w-full px-3 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Token d'accès (PAT)</label>
                        <div class="relative">
                            <input type="password" id="gh-token" placeholder="github_pat_..."
                                class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition">
                            <i class="fas fa-key absolute left-3 top-3 text-slate-400"></i>
                        </div>
                        <div class="mt-2 text-xs text-slate-500 bg-slate-50 p-2 rounded border border-slate-200">
                            <p class="font-medium mb-1">Recommandé : Fine-grained Token</p>
                            <ol class="list-decimal pl-4 space-y-1">
                                <li>Allez dans <em>Developer Settings > Personal access tokens </em></li>
                                <li>Sélectionnez uniquement ce dépôt</li>
                                <li>Permissions : <strong>Contents</strong> (Read and Write)</li>
                            </ol>
                        </div>
                    </div>

                    <button onclick="saveGitHubConfig()"
                        class="w-full py-2.5 bg-slate-800 hover:bg-slate-900 text-white rounded-lg font-bold transition shadow-lg flex items-center justify-center gap-2 mt-2">
                        <i class="fas fa-save"></i>
                        Sauvegarder
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Overlay (Hidden by default) -->
    <div id="login-overlay"
        class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md mx-4">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-slate-800">Connexion Admin</h2>
                <p class="text-slate-500 text-sm mt-2">Veuillez vous identifier pour accéder au tableau de bord.</p>
            </div>

            <form id="dashboard-login-form" class="space-y-6">
                <div>
                    <label for="dash-email" class="block text-sm font-medium text-slate-700 mb-1">Email</label>
                    <input type="email" id="dash-email" required
                        class="block w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                        placeholder="admin@example.com">
                </div>

                <div>
                    <label for="dash-password" class="block text-sm font-medium text-slate-700 mb-1">Mot de
                        passe</label>
                    <input type="password" id="dash-password" required
                        class="block w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                        placeholder="••••••••">
                </div>

                <div id="dash-login-error" class="hidden text-red-500 text-sm text-center bg-red-50 p-2 rounded-lg">
                    Identifiants incorrects.
                </div>

                <button type="submit"
                    class="w-full py-2.5 px-4 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-medium rounded-lg shadow-sm transition transform hover:scale-[1.02]">
                    Se connecter
                </button>
            </form>
        </div>
    </div>

    <script src="./../core/admin.js"></script>
    <script>
        // Dark Mode Toggle
        function toggleDarkMode() {
            const body = document.body;
            const toggle = document.getElementById('theme-toggle');
            const slider = toggle.querySelector('.theme-toggle-slider');
            const label = document.getElementById('theme-label');

            body.classList.toggle('dark');
            toggle.classList.toggle('dark');

            // Update icon and label
            if (body.classList.contains('dark')) {
                label.textContent = 'Mode clair';
                localStorage.setItem('stackpages_theme', 'dark');
            } else {
                label.textContent = 'Mode sombre';
                localStorage.setItem('stackpages_theme', 'light');
            }
        }

        // Initialize theme on load
        function initTheme() {
            const savedTheme = localStorage.getItem('stackpages_theme');
            const body = document.body;
            const toggle = document.getElementById('theme-toggle');
            const slider = toggle?.querySelector('.theme-toggle-slider');
            const label = document.getElementById('theme-label');

            if (savedTheme === 'dark') {
                body.classList.add('dark');
                toggle?.classList.add('dark');
                if (label) label.textContent = 'Mode clair';
            }
        }

        // Initialize theme when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();

            // Display site domain in header button
            const domainLinkEl = document.getElementById('site-domain-link');
            if (domainLinkEl) {
                domainLinkEl.textContent = window.location.hostname || 'localhost';
            }
        });

        // Logout Handler
        async function logout() {
            await fetch('/api/logout');
            localStorage.removeItem('stackpages_auth');
            window.location.href = '/admin';
        }
    </script>

    <!--<script>
        // integration de Chat WhatsApp
        new WAChatBox({
            link: "https://wa.me/2250747288793",
            user: {
                name: "Ange",
                avatar: "https://img.icons8.com/?size=100&id=23460&format=png&color=000000",
                status: "Typically replies within an hour",
            },
            text: `Hey There 👋<br><br>I'm here to help, so let me know what's up and I'll be happy to find a solution 🤓`,
            button_text: "Need Help?",
        });
    </script> -->
</body>

</html>